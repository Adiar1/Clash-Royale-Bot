<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Explorer</title>
    <style>
        :root {
            --primary-color: #7B68EE;
            --background-dark: #1E133E;
            --secondary-dark: #2C2541;
            --text-color: #E0E0E0;
            --hover-color: #4A3A6D;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        html, body {
            max-width: 100%;
            overflow-x: hidden;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--background-dark);
            color: var(--text-color);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            perspective: 1000px;
        }
        .container {
            background-color: var(--secondary-dark);
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            padding: 40px;
            width: 100%;
            max-width: 800px;
            text-align: center;
            transition: transform 0.3s ease;
            transform-style: preserve-3d;
            will-change: transform;
            position: relative;
            z-index: 1;
            margin: 20px;
        }
        h1 {
            color: var(--primary-color);
            margin-bottom: 30px;
            font-size: 2.5rem;
            text-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
        }
        .current-path {
            color: var(--primary-color);
            margin-bottom: 20px;
            font-size: 1.2rem;
            opacity: 0.8;
            word-break: break-all;
        }
        .file-list {
            text-align: left;
            max-height: 500px;
            overflow-y: auto;
            overflow-x: hidden;
            padding-right: 10px;
        }
        .file-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 20px;
            background-color: var(--background-dark);
            border-radius: 10px;
            margin-bottom: 10px;
            transition: all 0.3s ease;
            text-decoration: none;
            width: 100%;
        }
        .file-item:hover {
            background-color: var(--hover-color);
            transform: scale(1.02);
        }
        .file-name {
            display: flex;
            align-items: center;
            gap: 15px;
            color: var(--text-color);
            font-size: 1rem;
            max-width: 70%;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .file-icon {
            width: 24px;
            height: 24px;
            flex-shrink: 0;
        }
        .file-action {
            color: var(--primary-color);
            font-weight: 600;
            opacity: 0.8;
        }
        .nav-link {
            color: var(--primary-color);
            text-decoration: none;
            padding: 10px 15px;
            background-color: var(--background-dark);
            border-radius: 5px;
            transition: all 0.3s ease;
            display: inline-block;
            margin-top: 20px;
        }
        .nav-link:hover {
            background-color: var(--hover-color);
            transform: scale(1.1);
        }
        .back-link {
            position: absolute;
            top: 20px;
            left: 20px;
            color: var(--primary-color);
            text-decoration: none;
            font-weight: bold;
            transition: transform 0.3s ease;
        }
        .back-link:hover {
            transform: scale(1.1);
        }
        /* Scrollbar styling */
        .file-list::-webkit-scrollbar {
            width: 10px;
        }
        .file-list::-webkit-scrollbar-track {
            background: var(--background-dark);
        }
        .file-list::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="/" class="back-link">‚Üê Back to Dashboard</a>
        <h1>File Explorer</h1>
        <div class="current-path">Current Path: {{ current_dir or '/' }}</div>

        <div class="file-list">
            {% for file in files %}
                {% if file.is_dir %}
                    <a href="/files?dir={{ (current_dir + '/' + file.name).lstrip('/') }}" class="file-item">
                        <div class="file-name">
                            <svg class="file-icon" viewBox="0 0 24 24" fill="#7B68EE">
                                <path d="M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z"/>
                                <path d="M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z" fill="#FFA500" fill-opacity="0.3"/>
                            </svg>
                            {{ file.name }}/
                        </div>
                        <span class="file-action">Open Folder</span>
                    </a>
                {% endif %}
            {% endfor %}

            {% for file in files %}
                {% if not file.is_dir %}
                    <a href="/files?dir={{ file.path }}" class="file-item">
                        <div class="file-name">
                            {% if file.name.endswith('.py') %}
                                {% elif file.name.endswith('.py') %}
                                <svg class="file-icon" viewBox="0 0 400 418" fill="#3776AB">
                                    <path d="M300.692 110.242 C 300.531 110.402,300.400 121.465,300.400 134.827 C 300.400 162.213,300.228 164.349,297.345 172.790 C 292.135 188.043,282.552 197.795,268.301 202.350 C 259.906 205.033,262.277 204.925,205.800 205.199 L 154.600 205.447 150.600 206.350 C 128.642 211.306,115.946 224.253,113.231 244.455 C 112.689 248.488,112.619 338.221,113.155 341.000 C 118.485 368.605,157.143 383.699,215.184 380.837 C 256.192 378.815,281.809 367.621,287.760 349.122 L 288.828 345.800 288.714 322.600 L 288.600 299.400 244.500 299.298 L 200.400 299.196 200.400 292.998 L 200.400 286.800 265.956 286.800 C 338.081 286.800,333.936 286.935,341.754 284.337 C 361.551 277.760,374.595 260.047,380.465 231.772 L 381.788 225.400 381.919 201.000 C 382.058 174.939,382.044 174.672,379.963 164.200 C 374.247 135.437,360.223 116.527,340.600 111.122 C 337.325 110.220,301.503 109.430,300.692 110.242 M257.249 322.866 C 267.369 327.472,269.771 340.667,261.918 348.520 C 254.589 355.849,241.719 353.989,236.890 344.901 C 229.732 331.432,243.450 316.584,257.249 322.866 "/>
                                </svg>
                            {% elif file.name.endswith('.md') %}
                                <svg class="file-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 247.52" fill="#7B68EE">
                                    <path d="M36.286 43.534 L 26.097 43.940 26.364 124.059 L 26.632 204.178 49.608 204.178 L 72.585 204.178 72.281 158.978 C 72.114 134.117,72.290 113.270,72.674 112.650 C 73.486 111.336,73.430 111.274,92.973 135.770 C 100.992 145.822,110.260 157.421,113.568 161.545 C 116.876 165.669,120.127 169.076,120.794 169.117 C 121.919 169.185,131.202 157.923,157.172 124.985 C 162.912 117.705,167.959 111.749,168.388 111.749 C 168.818 111.749,169.291 132.546,169.441 157.963 L 169.713 204.178 192.167 204.178 L 214.621 204.178 214.889 124.182 L 215.156 44.186 200.471 43.558 C 175.827 42.504,168.611 43.396,165.016 47.941 C 136.626 83.842,121.847 101.828,120.736 101.828 C 119.983 101.828,113.541 94.477,106.420 85.492 C 99.299 76.507,88.875 63.466,83.255 56.510 L 73.037 43.864 67.486 43.864 C 64.432 43.864,58.456 43.699,54.205 43.496 C 49.953 43.294,41.890 43.311,36.286 43.534 M297.401 83.812 L 297.128 123.760 274.935 124.042 C 259.834 124.233,252.742 124.686,252.742 125.458 C 252.742 128.550,318.415 204.700,321.082 204.700 C 321.766 204.700,325.624 200.822,329.656 196.084 C 333.689 191.345,343.528 179.918,351.522 170.691 C 376.645 141.696,389.488 126.061,388.929 125.156 C 388.632 124.675,378.547 124.282,366.518 124.282 L 344.648 124.282 344.648 106.174 C 344.648 96.214,344.338 78.120,343.959 65.965 L 343.271 43.864 320.473 43.864 L 297.675 43.864 297.401 83.812 " />
                                </svg>
                            {% else %}
                                <svg class="file-icon" viewBox="0 0 24 24" fill="#607D8B">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z" fill="#607D8B"/>
                                    <path d="M13 9V3.5L18.5 9H13z" fill="#CFD8DC"/>
                                </svg>
                            {% endif %}
                            {{ file.name }}
                        </div>
                        <span class="file-action">View File</span>
                    </a>
                {% endif %}
            {% endfor %}
        </div>
    </div>
</body>
</html>